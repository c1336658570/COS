fdisk ./file_system.img

来使用fdisk工具来为刚刚创建的磁盘开始进行分区。

然后在输入框依次输入以下，输入一个，按一次回车

m 显示菜单

x 使用额外功能

m 显示菜单

c 设定柱面

162

h 设定磁头数

16

r 返回上一级菜单

n 新增一个分区

p 分区是个主分区

1 分区号设定为1

2048 在旧的fdisk版本中，通常使用"柱面"（Cylinders）、“磁头”（Heads）和"扇区"（Sectors）这些术语来描述磁盘布局。现代磁盘和磁盘管理工具通常直接以扇区为单位进行操作。作者的1分区起始柱面是1，计算得起始扇区应该是63 * 16 = 1008，我们创建hd80M.img时，会提示Creating hard disk image 'hd80M.img' with CHS=162/16/63，意思就是柱面162个，磁头16个，每个磁道63个扇区。但是由于fdisk工具指定第一个分区最小起始扇区为2048，所以我们只能设定1分区起始扇区为2048

33263 作者指定了1分区结束柱面为32，计算得结束扇区为（32 + 1）* 16 * 63 - 1 = 33263，-1 是因为扇区从0开始编号

n 新增一个分区

e 分区是个扩展分区。最初磁盘只支持最多分4个区。但是后来由于需求增加，磁盘需要支持能分更多区，同时又为了能够兼容旧有的最多支持4个分区，所以就发明了扩展分区。扩展分区并不直接用于存储数据，而是作为一个容器，可以创建多个逻辑分区在其中。这样，即使主分区的数量限制为四个，我们仍然可以在一个扩展分区中创建多个逻辑分区，从而实现对更多分区的需求。一个磁盘，最多一个扩展分区。

4 分区号码设定为4

33264 分区起始扇区设定为分区1结束扇区下一个扇区

163295 分区结束扇区设定为整个磁盘最后一个扇区，也就是说我们这个磁盘就两个分区，一个主分区1，一个扩展分区4

p 查看现有分区

n 创建分区，由于我们现在磁盘已经被两个分区占满了，所以不能再支持新的主分区创建，又由于扩展分区只能有1个，所以不能再支持扩展分区的创建。所以此时输入n，直接是创建逻辑分区（扩展分区再次分区后，每个分区叫做逻辑分区）

35312 直接设定工具允许的逻辑分区起始最小扇区

51407 作者指定了逻辑分区5结束柱面为50，计算得结束扇区为（50 + 1）* 16 * 63 - 1 = 51407，-1 是因为扇区从0开始编号

n 创建分区

53456 直接设定工具允许的逻辑分区起始最小扇区

76607 作者指定了逻辑分区6结束柱面为75，计算得结束扇区为（75 + 1）* 16 * 63 - 1 = 76607，-1 是因为扇区从0开始编号

n 创建分区

78656 直接设定工具允许的逻辑分区起始最小扇区

91727 作者指定了逻辑分区7结束柱面为90，计算得结束扇区为（90 + 1）* 16 * 63 - 1 = 91727，-1 是因为扇区从0开始编号

n 创建分区

93776 直接设定工具允许的逻辑分区起始最小扇区

121967 作者指定了逻辑分区8结束柱面为120，计算得结束扇区为（120 + 1）* 16 * 63 - 1 = 121967，-1 是因为扇区从0开始编号

n 创建分区

124016 直接设定工具允许的逻辑分区起始最小扇区

163295 设定最后一个可用扇区为逻辑分区9的结束扇区

p 显示分区

t 设定分区类型id

5 改变逻辑分区5的类型id

66 设定类型id为0x66

t 设定分区类型id

6 改变逻辑分区6的类型id

66 设定类型id为0x66

t 设定分区类型id

7 改变逻辑分区7的类型id

66 设定类型id为0x66

t 设定分区类型id

8 改变逻辑分区8的类型id

66 设定类型id为0x66

t 设定分区类型id

9 改变逻辑分区9的类型id

66 设定类型id为0x66

p 显示分区

w 将分区表写入磁盘，并退出fdisk 分区表是用于描述每个分区的信息，详见P571

fdisk -l hd80M.img 查看分区信息
